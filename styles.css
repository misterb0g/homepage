/* =========================
   Typo : Inter
   ========================= */
:root { --fontFamily: 'Inter', system-ui, -apple-system, 'Segoe UI', sans-serif; }
html, body, input, button, a, textarea { font-family: var(--fontFamily); }
body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }

/* =========================
   Thème + Variables
   ========================= */
:root,
:root[data-theme="dark"] {
  --bg: #1c1c1e;
  --fg: #f5f5f7;
  --secondaryFg: #a1a1a6;
  --containerBg: #2c2c2e;
  --scrollbarColor: #4a4a4f;
  --glass-bg: rgba(44,44,46,0.6);
  --glass-border: rgba(255,255,255,.1);
  --glass-shadow: 0 8px 32px rgba(0,0,0,.3);
  --mac-brand: #007aff;
  --radius: 16px;
  --spot-h: 52px;
}
:root[data-theme="light"] {
  --bg: #f2f2f7;
  --fg: #1d1d1f;
  --secondaryFg: #6e6e73;
  --containerBg: #ffffff;
  --scrollbarColor: #c7c7cc;
  --glass-bg: rgba(255,255,255,0.65);
  --glass-border: rgba(0,0,0,.08);
  --glass-shadow: 0 8px 32px rgba(0,0,0,.1);
  --mac-brand: #007aff;
  --radius: 16px;
  --spot-h: 52px;
}

/* =========================
   Layout & Éléments Communs
   ========================= */
html, body { height: 100%; }
body {
  margin: 0;
  background-color: var(--bg);
  transition: background-color .3s ease;
}
.container {
  width: 100%;
  min-height: 100vh;
  padding: 3.2rem 1rem 2.2rem;
  display: flex;
  align-items: center;
  flex-direction: column;
  gap: 1.2rem;
  box-sizing: border-box;
}

.top-controls {
  position: fixed; top: 1rem; right: 1rem; z-index: 1001;
}
.btn-icon {
  appearance: none; border: none; background: transparent; color: var(--fg);
  padding: .25rem; border-radius: 10px; cursor: pointer;
  transition: opacity .2s ease, transform .1s ease;
  width: 36px; height: 36px; display: inline-flex; align-items: center; justify-content: center;
}
.btn-icon:hover { opacity: .8; }
.btn-icon:active { transform: scale(.95); }
.btn-icon svg { width: 22px; height: 22px; fill: none; stroke: currentColor; stroke-width: 1.5; }

.card {
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-shadow);
  overflow: hidden;
  transition: box-shadow .3s ease, border-color .3s ease, transform .2s ease;
}
.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--glass-shadow), 0 12px 24px rgba(0,0,0,0.15);
}
/* On retire #chat-container:hover de la règle d'annulation */
.weather-details:hover {
    transform: none;
    box-shadow: var(--glass-shadow);
}


.glass {
  background: var(--glass-bg);
  -webkit-backdrop-filter: blur(20px);
  backdrop-filter: blur(20px);
}

/* Horloge */
#clock {
  font-size: clamp(2.4rem, 6vw, 3.2rem);
  font-weight: 700; color: var(--fg);
}

/* Météo */
.weather-container { width: min(640px, 92%); padding: 0.7rem; text-align: center; color: var(--fg); cursor: pointer; }
.inline { display: inline-block; margin: 0 .5ch; }
.weather-details { width: min(820px, 94%); padding: 0.9rem; }
.weather5d { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 0.7rem; }
.weather-day { padding: .6rem .8rem; border-radius: 12px; background: color-mix(in srgb, var(--fg) 5%, transparent); }
.wd-date { font-weight: 600; margin-bottom: .2rem; text-transform: capitalize; color: var(--fg); }
.wd-desc { color: var(--secondaryFg); font-size: .9rem; margin-bottom: .2rem; }
.wd-temps .max { font-weight: 700; color: var(--fg); }
.wd-temps .min { color: var(--secondaryFg); }

/* Spotlight (barre Google) */
.spotlight {
  width: min(920px, 94%);
  height: var(--spot-h);
  margin: 0.6rem auto 2.2rem;
  display: flex;
  align-items: center;
  padding: 0 1.1rem;
  border-radius: 99px; 
  transition: box-shadow .3s ease, border-color .3s ease, transform .2s ease;
}
.spotlight:focus-within,
.spotlight:hover {
  transform: translateY(-2px);
  box-shadow: var(--glass-shadow), 0 0 0 4px color-mix(in srgb, var(--mac-brand) 20%, transparent);
}
.search-icon {
  width: 22px;
  height: 22px;
  fill: var(--secondaryFg);
  transition: fill .2s ease;
  margin-right: 0.6rem;
}
.spotlight:focus-within .search-icon {
  fill: var(--mac-brand);
}
.spotlight input[type="search"] {
  width: 100%;
  height: 100%;
  border: none;
  background: transparent;
  color: var(--fg);
  font-size: 1.1rem;
  outline: none;
  padding: 0;
}

.visually-hidden { position: absolute !important; height: 1px; width: 1px; overflow: hidden; clip: rect(1px,1px,1px,1px); }

/* Bookmarks */
#bookmark-container {
  display: grid;
  grid-template-columns: repeat(4, minmax(220px, 1fr));
  gap: 0.7rem;
  width: min(1400px, 94%);
  margin: 0 auto 2.2rem;
  box-sizing: border-box;
}
.bookmark-set { padding: 0.7rem; }
.bookmark-inner-container { overflow-y: auto; max-height: 60vh; padding-right: 6px; scrollbar-width: thin; scrollbar-color: var(--scrollbarColor) transparent; }
.bookmark-inner-container::-webkit-scrollbar { width: 6px; }
.bookmark-inner-container::-webkit-scrollbar-thumb { background-color: var(--scrollbarColor); border-radius: 6px; }
.bookmark-title { font-size: 1.05rem; font-weight: 600; color: var(--fg); margin: 0 0 .5rem 0; }
.bookmark { display: block; text-decoration: none; color: var(--secondaryFg); margin: .45rem 0; font-size: 0.95rem; transition: color .2s ease; padding: .25rem .3rem; border-radius: 8px; }
.bookmark:hover { color: var(--fg); }

/* Responsive Bookmarks */
@media (max-width: 1280px) { #bookmark-container { grid-template-columns: repeat(3, minmax(200px, 1fr)); } }
@media (max-width: 960px)  { #bookmark-container { grid-template-columns: repeat(2, minmax(180px, 1fr)); } }
@media (max-width: 600px)  { #bookmark-container { grid-template-columns: 1fr; } }


/* --- Styles pour le Conteneur de Chat --- */
#chat-container {
  width: min(920px, 94%);
  margin: 1rem auto 0.8rem;
  padding: 0.7rem;
  color: var(--fg);
  display: flex;
  flex-direction: column;
}

/* NOUVEAU STYLE D'ONGLETS "PILULE" */
.chat-tabs {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.8rem;
  padding: 0.3rem;
  background: color-mix(in srgb, var(--bg) 70%, transparent);
  border-radius: 12px;
  align-self: center;
  flex-shrink: 0;
}
.chat-tab {
  appearance: none;
  border: none;
  background: transparent;
  color: var(--secondaryFg);
  padding: 0.4rem 0.8rem;
  border-radius: 9px;
  font-weight: 500;
  cursor: pointer;
  transition: background .2s ease, color .2s ease;
}
.chat-tab.active {
  background: var(--containerBg);
  color: var(--fg);
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.chat-tab:not(.active):hover {
  color: var(--fg);
}


/* Panneaux de Chat */
.chat-panel {
  display: none; 
  flex-direction: column;
}
.chat-panel:not([hidden]) {
  display: flex;
}

.chat-messages {
  max-height: 320px;
  overflow-y: auto;
  padding: 0.5rem 0.3rem;
  margin-bottom: .8rem;
  display: flex;
  flex-direction: column;
  gap: .6rem;
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbarColor) transparent;
}
.chat-messages::-webkit-scrollbar { width: 6px; }
.chat-messages::-webkit-scrollbar-thumb { background-color: var(--scrollbarColor); border-radius: 6px; }

/* DESIGN DES BULLES DE MESSAGE (NEUTRE) */
.msg { 
  padding: .7rem 1rem; 
  border-radius: 14px; 
  line-height: 1.45; 
  white-space: pre-wrap; 
  max-width: 85%;
}
.msg.you { 
  align-self: flex-end; 
  background: color-mix(in srgb, var(--fg) 15%, transparent);
  color: var(--fg);
}
.msg.bot { 
  align-self: flex-start; 
  background: var(--containerBg);
}
.msg.pending::after {
  content: '▋';
  display: inline-block;
  animation: blink 1s infinite;
  vertical-align: baseline;
}
@keyframes blink { 50% { opacity: 0; } }

.chat-form {
  width: 100%;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: .6rem;
  flex-shrink: 0;
}
.chat-form input[type="text"] {
  height: 48px;
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--bg);
  color: var(--fg);
  padding: 0 .9rem;
  outline: none;
  font-size: 1rem;
}
.chat-form input[type="text"]:focus {
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--mac-brand) 20%, transparent);
}

/* DESIGN DU BOUTON ENVOYER (NEUTRE) */
.chat-form button {
  height: 48px;
  min-width: 120px;
  border-radius: var(--radius);
  border: 1px solid var(--glass-border);
  background: var(--fg);
  color: var(--bg);
  padding: 0 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: filter .2s ease, transform .1s ease;
  backdrop-filter: none;
}
.chat-form button:hover { 
  filter: brightness(.92); 
}
:root[data-theme="dark"] .chat-form button:hover {
  filter: brightness(1.1);
}
.chat-form button:active { 
  transform: scale(0.98); 
}

.hint {
  font-size: 0.8rem;
  color: var(--secondaryFg);
  text-align: center;
  margin: 0.8rem 0 0.2rem;
}